window.onload = () => {
    const greetings = [
        "Hi ğŸ‘‹ Welcome!",
        "Hello ğŸ˜Š How can I help you today?",
        "Hey there! Feel free to ask me anything ğŸŒŸ"
    ];

    const greet = greetings[Math.floor(Math.random() * greetings.length)];
    add(greet, "bot");
};

const chatArea = document.getElementById("chatArea");
const input = document.getElementById("question");

input.addEventListener("keydown", e => {
    if (e.key === "Enter") ask();
});

function ask() {
    const q = input.value.trim();
    if (!q) return;

    add(q, "user");
    input.value = "";

    setTimeout(() => {
        add(buildAnswer(q), "bot");
    }, 600);
}

function speakText(text) {
    // Remove emojis and special formatting for speech
    const cleanText = text.replace(/[^\w\s\-']/g, ' ').trim();
    const utterance = new SpeechSynthesisUtterance(cleanText);
    utterance.rate = 1;
    utterance.pitch = 1;
    utterance.volume = 1;
    window.speechSynthesis.speak(utterance);
}

function add(text, type) {
    const div = document.createElement("div");
    div.className = type;
    div.innerText = text;
    chatArea.appendChild(div);
    chatArea.scrollTop = chatArea.scrollHeight;
}

function buildAnswer(question) {

    const q = question.toLowerCase();
    const today = new Date();
    const player = document.getElementById("audioPlayer");

    // ğŸ”Š CHECK IF USER WANTS VOICE
    const needsVoice = q.includes("speak") || q.includes("say") || q.includes("tell me") || q.includes("voice");

    // ğŸ”¹ TIME
    if (q.includes("time")) {
        const answer = "The current time is â° " + today.toLocaleTimeString();
        if (needsVoice) speakText(answer);
        return answer;
    }

    // ğŸ”¹ TOMORROW / YESTERDAY
    if (q.includes("tomorrow")) {
        const t = new Date(today);
        t.setDate(today.getDate() + 1);
        const answer = "Tomorrow's date is ğŸ“… " + t.toLocaleDateString();
        if (needsVoice) speakText(answer);
        return answer;
    }

    if (q.includes("yesterday")) {
        const y = new Date(today);
        y.setDate(today.getDate() - 1);
        const answer = "Yesterday's date was ğŸ“… " + y.toLocaleDateString();
        if (needsVoice) speakText(answer);
        return answer;
    }

    if (q.includes("date") || q.includes("today")) {
        const answer = "Today's date is ğŸ“… " + today.toLocaleDateString();
        if (needsVoice) speakText(answer);
        return answer;
    }

    // ğŸ¶ TAMIL SONG REQUESTS
    if (q.includes("tamil song") || q.includes("play song")) {

        // Default song
        player.src = "songs/arabic_kuthu.mp3";
        player.style.display = "block";
        player.play();

        return "ğŸ¶ Playing a Tamil song for you ğŸ˜Š Relax and enjoy!";
    }

    if (q.includes("vaathi")) {
        player.src = "songs/vaathi_coming.mp3";
        player.style.display = "block";
        player.play();

        return "ğŸ”¥ Playing *Vaathi Coming*! Enjoy the vibe ğŸ˜";
    }

    // ğŸ”¹ SIMPLE KNOWLEDGE
    if (q.includes("what is html")) {
        const answer = "HTML is used to create the structure of web pages.";
        if (needsVoice) speakText(answer);
        return answer;
    }

    if (q.includes("what is css")) {
        const answer = "CSS is used to style web pages.";
        if (needsVoice) speakText(answer);
        return answer;
    }

    if (q.includes("who are you")) {
        const answer = "I'm your friendly offline assistant ğŸ˜Š Always here to help.";
        if (needsVoice) speakText(answer);
        return answer;
    }

    // ğŸŒŸ UNIVERSAL FRIENDLY RESPONSE
    return (
    );
}

